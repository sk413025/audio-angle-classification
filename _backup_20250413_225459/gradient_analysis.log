分析檢查點: /Users/sbplab/Hank/angle_classification_deg6/saved_models/model_checkpoints/plastic_3000hz/model_epoch_30_20250409_174107.pt
使用設備: mps
警告: 直接從 config.py 讀取隨機種子: 42
       請確保此種子與生成此檢查點的訓練運行所使用的種子一致。
已使用種子 42 設置隨機狀態。
從路徑推斷出 材質: plastic, 頻率: 3000hz
Loading Dataset for 3000hz with material plastic

Class deg000 (label 0):
Found 9 files for class deg000

Class deg036 (label 1):
Found 9 files for class deg036

Class deg072 (label 2):
Found 9 files for class deg072

Class deg108 (label 3):
Found 9 files for class deg108

Class deg144 (label 4):
Found 9 files for class deg144

Class deg180 (label 5):
Found 9 files for class deg180

Spectrograms shape: torch.Size([54, 1, 1025, 1126])
Frequency range: 0.0-24000.0 Hz
使用種子 42 重新創建了訓練/驗證分割。訓練集大小: 48
Created 1933 ranking pairs
創建排序對數據集，大小: 1933
使用批次大小: 4
數據加載器創建完成。批次數量: 483
ResNet 骨幹已凍結，只訓練分類器層和prompt模板
模型架構初始化並加載權重完成。
開始計算所有批次的梯度範數...
  批次 15: 檢測到高梯度範數 1.93e+01
  已處理批次 20/483...
  批次 36: 檢測到高梯度範數 2.49e+01
  已處理批次 40/483...
  批次 42: 檢測到高梯度範數 1.54e+01
  批次 54: 檢測到高梯度範數 2.02e+01
  批次 56: 檢測到高梯度範數 1.20e+01
  批次 58: 檢測到高梯度範數 1.05e+01
  已處理批次 60/483...
  批次 65: 檢測到高梯度範數 2.68e+01
  已處理批次 80/483...
  批次 80: 檢測到高梯度範數 1.77e+01
  批次 93: 檢測到高梯度範數 1.23e+01
  已處理批次 100/483...
  批次 117: 檢測到高梯度範數 9.49e+00
  已處理批次 120/483...
  已處理批次 140/483...
  批次 152: 檢測到高梯度範數 2.44e+01
  批次 153: 檢測到高梯度範數 1.30e+01
  已處理批次 160/483...
  批次 162: 檢測到高梯度範數 9.46e+00
  批次 171: 檢測到高梯度範數 2.25e+01
  批次 173: 檢測到高梯度範數 1.09e+01
  已處理批次 180/483...
  批次 191: 檢測到高梯度範數 1.43e+01
  批次 192: 檢測到高梯度範數 2.89e+01
  批次 198: 檢測到高梯度範數 1.48e+01
  已處理批次 200/483...
  已處理批次 220/483...
  批次 225: 檢測到高梯度範數 5.32e+01
  批次 232: 檢測到高梯度範數 2.44e+01
  已處理批次 240/483...
  批次 252: 檢測到高梯度範數 1.12e+01
  批次 258: 檢測到高梯度範數 2.48e+01
  已處理批次 260/483...
  批次 275: 檢測到高梯度範數 1.33e+01
  已處理批次 280/483...
  批次 293: 檢測到高梯度範數 1.10e+01
  批次 295: 檢測到高梯度範數 1.29e+01
  已處理批次 300/483...
  批次 308: 檢測到高梯度範數 1.95e+01
  已處理批次 320/483...
  批次 332: 檢測到高梯度範數 3.11e+01
  已處理批次 340/483...
  批次 340: 檢測到高梯度範數 2.04e+01
  批次 350: 檢測到高梯度範數 1.85e+01
  已處理批次 360/483...
  已處理批次 380/483...
  批次 380: 檢測到高梯度範數 1.50e+01
  批次 387: 檢測到高梯度範數 2.40e+01
  批次 389: 檢測到高梯度範數 1.78e+01
  批次 397: 檢測到高梯度範數 1.17e+01
  已處理批次 400/483...
  已處理批次 420/483...
  已處理批次 440/483...
  已處理批次 460/483...
  批次 464: 檢測到高梯度範數 1.21e+01
  批次 466: 檢測到高梯度範數 1.09e+01
  批次 468: 檢測到高梯度範數 1.46e+01
  已處理批次 480/483...
梯度範數計算完成。共收集到 483 個範數。

檢測到的異常批次:
  批次 15: 範數 = 1.93e+01, 標籤對 = (tensor([3, 4, 3, 0]), tensor([2, 5, 2, 3]))
  批次 36: 範數 = 2.49e+01, 標籤對 = (tensor([2, 4, 1, 5]), tensor([3, 3, 3, 1]))
  批次 42: 範數 = 1.54e+01, 標籤對 = (tensor([2, 3, 0, 2]), tensor([3, 2, 1, 0]))
  批次 54: 範數 = 2.02e+01, 標籤對 = (tensor([4, 1, 2, 3]), tensor([5, 0, 1, 4]))
  批次 56: 範數 = 1.20e+01, 標籤對 = (tensor([3, 0, 4, 3]), tensor([1, 1, 1, 2]))
  批次 58: 範數 = 1.05e+01, 標籤對 = (tensor([0, 5, 2, 4]), tensor([2, 3, 3, 2]))
  批次 65: 範數 = 2.68e+01, 標籤對 = (tensor([2, 3, 1, 2]), tensor([3, 2, 0, 4]))
  批次 80: 範數 = 1.77e+01, 標籤對 = (tensor([1, 5, 1, 1]), tensor([0, 3, 2, 3]))
  批次 93: 範數 = 1.23e+01, 標籤對 = (tensor([0, 2, 2, 3]), tensor([3, 3, 5, 1]))
  批次 117: 範數 = 9.49e+00, 標籤對 = (tensor([1, 5, 3, 2]), tensor([0, 4, 2, 5]))
  批次 152: 範數 = 2.44e+01, 標籤對 = (tensor([5, 2, 3, 0]), tensor([3, 0, 4, 1]))
  批次 153: 範數 = 1.30e+01, 標籤對 = (tensor([2, 5, 3, 2]), tensor([3, 4, 4, 1]))
  批次 162: 範數 = 9.46e+00, 標籤對 = (tensor([0, 0, 2, 2]), tensor([1, 1, 3, 4]))
  批次 171: 範數 = 2.25e+01, 標籤對 = (tensor([3, 2, 0, 1]), tensor([4, 1, 4, 0]))
  批次 173: 範數 = 1.09e+01, 標籤對 = (tensor([2, 0, 1, 1]), tensor([3, 5, 4, 3]))
  批次 191: 範數 = 1.43e+01, 標籤對 = (tensor([5, 3, 3, 2]), tensor([4, 2, 1, 5]))
  批次 192: 範數 = 2.89e+01, 標籤對 = (tensor([2, 3, 3, 5]), tensor([4, 4, 5, 3]))
  批次 198: 範數 = 1.48e+01, 標籤對 = (tensor([3, 3, 3, 1]), tensor([1, 2, 0, 4]))
  批次 225: 範數 = 5.32e+01, 標籤對 = (tensor([3, 4, 1, 5]), tensor([2, 2, 2, 3]))
  批次 232: 範數 = 2.44e+01, 標籤對 = (tensor([5, 1, 5, 3]), tensor([1, 2, 3, 1]))
  批次 252: 範數 = 1.12e+01, 標籤對 = (tensor([1, 3, 3, 1]), tensor([5, 2, 1, 4]))
  批次 258: 範數 = 2.48e+01, 標籤對 = (tensor([3, 5, 3, 5]), tensor([2, 3, 4, 1]))
  批次 275: 範數 = 1.33e+01, 標籤對 = (tensor([2, 4, 5, 5]), tensor([3, 1, 3, 2]))
  批次 293: 範數 = 1.10e+01, 標籤對 = (tensor([2, 3, 1, 3]), tensor([5, 2, 3, 4]))
  批次 295: 範數 = 1.29e+01, 標籤對 = (tensor([5, 2, 1, 2]), tensor([3, 5, 0, 3]))
  批次 308: 範數 = 1.95e+01, 標籤對 = (tensor([3, 3, 5, 4]), tensor([5, 2, 4, 2]))
  批次 332: 範數 = 3.11e+01, 標籤對 = (tensor([5, 1, 3, 1]), tensor([4, 2, 2, 4]))
  批次 340: 範數 = 2.04e+01, 標籤對 = (tensor([5, 5, 0, 1]), tensor([4, 3, 1, 2]))
  批次 350: 範數 = 1.85e+01, 標籤對 = (tensor([2, 3, 1, 5]), tensor([4, 4, 2, 3]))
  批次 380: 範數 = 1.50e+01, 標籤對 = (tensor([2, 0, 4, 4]), tensor([3, 1, 5, 1]))
  批次 387: 範數 = 2.40e+01, 標籤對 = (tensor([2, 1, 1, 2]), tensor([3, 5, 5, 3]))
  批次 389: 範數 = 1.78e+01, 標籤對 = (tensor([4, 1, 2, 5]), tensor([5, 4, 1, 2]))
  批次 397: 範數 = 1.17e+01, 標籤對 = (tensor([0, 0, 1, 3]), tensor([1, 1, 0, 2]))
  批次 464: 範數 = 1.21e+01, 標籤對 = (tensor([2, 1, 0, 3]), tensor([0, 3, 2, 2]))
  批次 466: 範數 = 1.09e+01, 標籤對 = (tensor([4, 0, 3, 3]), tensor([5, 5, 2, 1]))
  批次 468: 範數 = 1.46e+01, 標籤對 = (tensor([5, 2, 2, 5]), tensor([0, 1, 3, 4]))
Gradient norm distribution plot saved to: /Users/sbplab/Hank/angle_classification_deg6/saved_models/gradient_distribution_analysis/plastic_3000hz/epoch_30_seed_42/gradient_norm_distribution_epoch_30_seed_42.png

Gradient Norm Statistics (Epoch 30):
    
Sample Size: 483
    
Basic Statistics:
• Mean: 1.35e+00
• Median: 0.00e+00
• Std Dev: 5.28e+00
• Min: 0.00e+00
• Max: 5.32e+01

Percentiles:
• 25th: 0.00e+00
• 75th: 0.00e+00
• 95th: 1.28e+01
• 99th: 2.49e+01

Distribution Characteristics:
• Skewness: 4.77
• Kurtosis: 27.94
• IQR: 0.00e+00
• CV: 3.91

