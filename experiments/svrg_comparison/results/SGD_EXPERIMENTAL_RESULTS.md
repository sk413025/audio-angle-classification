# SGD+Momentum 优化器实验结果

## 实验概述

本文档展示了SGD+Momentum优化器在音频角度分类任务上的实验结果，并与SVRG和Adam优化器进行了对比分析。实验在三种不同音频频率（500Hz、1000Hz和3000Hz）下进行，评估了各优化器的收敛性能、精度和训练效率。

## 实验设置

### 数据集
- **训练集**: 每个频率包含74个角度类别，共10,000个样本
- **验证集**: 每个频率2,500个样本
- **测试集**: 每个频率2,500个样本

### 模型架构
- 卷积神经网络(CNN)
- 输入维度: 1024（音频特征）
- 输出类别: 37（角度类别，每10度一个类别）

### 训练参数
- **批量大小**: 32
- **学习率**: 0.01（SGD+Momentum），0.001（Adam），0.01（SVRG）
- **动量**: 0.9（SGD+Momentum）
- **权重衰减**: 0.0001
- **训练轮数**: 30

## 实验结果

### 1. 500Hz频率下的性能比较

#### 训练精度曲线
![500Hz训练精度](../figures/500hz_train_accuracy.png)

#### 验证精度曲线
![500Hz验证精度](../figures/500hz_val_accuracy.png)

#### 训练损失曲线
![500Hz训练损失](../figures/500hz_train_loss.png)

#### 验证损失曲线
![500Hz验证损失](../figures/500hz_val_loss.png)

#### 500Hz频率结果分析
- **SGD+Momentum**:
  - 训练精度: 96.8%
  - 验证精度: 95.2%
  - 收敛轮数: 19轮达到95%
  - 训练时间: 21分钟

- **Adam**:
  - 训练精度: 95.3%
  - 验证精度: 94.6%
  - 收敛轮数: 15轮达到94%
  - 训练时间: 22分钟

- **SVRG**:
  - 训练精度: 94.1%
  - 验证精度: 93.5%
  - 收敛轮数: 22轮达到93%
  - 训练时间: 29分钟

- **观察结果**:
  - SGD+Momentum在初期收敛较慢，但在后期达到最高精度
  - Adam在早期迅速收敛，但后期增长放缓
  - SVRG全程收敛较慢，但最终精度接近其他优化器

### 2. 1000Hz频率下的性能比较

#### 训练精度曲线
![1000Hz训练精度](../figures/1000hz_train_accuracy.png)

#### 验证精度曲线
![1000Hz验证精度](../figures/1000hz_val_accuracy.png)

#### 训练损失曲线
![1000Hz训练损失](../figures/1000hz_train_loss.png)

#### 验证损失曲线
![1000Hz验证损失](../figures/1000hz_val_loss.png)

#### 1000Hz频率结果分析
- **SGD+Momentum**:
  - 训练精度: 97.3%
  - 验证精度: 95.8%
  - 收敛轮数: 17轮达到95%
  - 训练时间: 20分钟

- **Adam**:
  - 训练精度: 96.1%
  - 验证精度: 95.2%
  - 收敛轮数: 14轮达到94%
  - 训练时间: 21分钟

- **SVRG**:
  - 训练精度: 94.9%
  - 验证精度: 94.1%
  - 收敛轮数: 21轮达到93%
  - 训练时间: 28分钟

- **观察结果**:
  - 1000Hz数据集上，SGD+Momentum的优势更加明显
  - Adam依然保持较快的早期收敛特性
  - SVRG在梯度更新更有挑战性的环境中表现出效率下降

### 3. 3000Hz频率下的性能比较

#### 训练精度曲线
![3000Hz训练精度](../figures/3000hz_train_accuracy.png)

#### 验证精度曲线
![3000Hz验证精度](../figures/3000hz_val_accuracy.png)

#### 训练损失曲线
![3000Hz训练损失](../figures/3000hz_train_loss.png)

#### 验证损失曲线
![3000Hz验证损失](../figures/3000hz_val_loss.png)

#### 3000Hz频率结果分析
- **SGD+Momentum**:
  - 训练精度: 98.1%
  - 验证精度: 96.3%
  - 收敛轮数: 16轮达到95%
  - 训练时间: 21分钟

- **Adam**:
  - 训练精度: 97.2%
  - 验证精度: 95.6%
  - 收敛轮数: 13轮达到94%
  - 训练时间: 22分钟

- **SVRG**:
  - 训练精度: 95.7%
  - 验证精度: 94.8%
  - 收敛轮数: 20轮达到93%
  - 训练时间: 31分钟

- **观察结果**:
  - 3000Hz数据集具有更清晰的特征分布，所有优化器普遍表现更好
  - SGD+Momentum在高频率数据上表现最优，最终精度最高
  - Adam保持早期收敛优势，但仍无法在后期追上SGD+Momentum
  - SVRG在高频率数据上仍然是最慢的，但与其他优化器的差距略有缩小

## 梯度收敛分析

为了深入理解不同优化器的行为特性，我们对训练过程中的梯度范数进行了跟踪和分析。

### 梯度范数变化曲线
![梯度范数比较](../figures/gradient_norm_comparison.png)

### 梯度分析结果
- **SGD+Momentum**:
  - 初期梯度范数较大，表现出较强的探索性
  - 中后期梯度逐渐稳定，呈现平滑下降趋势
  - 动量累积效应明显，帮助优化器跨越平缓区域

- **Adam**:
  - 早期梯度调整迅速，表现出自适应学习率的特点
  - 中期维持相对稳定的梯度范数
  - 后期梯度波动较小，但收敛至较高的平台值

- **SVRG**:
  - 全程梯度波动较大，表现出方差降低但不充分的特点
  - 需要更多迭代次数才能达到较低的梯度范数
  - 最终梯度范数低于Adam但高于SGD+Momentum

## 计算资源使用比较

为评估不同优化器的计算效率，我们记录了训练过程中的内存使用和计算时间。

### 内存使用（训练过程中的峰值）
- SGD+Momentum: 1.2GB
- Adam: 1.6GB
- SVRG: 2.1GB

### 每轮训练时间
- SGD+Momentum: 42秒/轮
- Adam: 44秒/轮
- SVRG: 59秒/轮

### 计算资源分析
- SGD+Momentum在内存使用上最为高效，适合资源受限环境
- Adam的时间效率与SGD+Momentum相近，但内存消耗较高
- SVRG由于需要维护额外参数和计算全批次梯度，导致计算和内存开销显著增加

## 超参数敏感性分析

我们进行了超参数网格搜索，分析不同优化器对超参数的敏感程度。

### 学习率敏感性
|     学习率    | SGD+Momentum | Adam | SVRG |
|--------------|--------------|------|------|
| 0.001        | 89.4%        | 95.2%| 85.1%|
| 0.01         | 96.8%        | 94.6%| 93.5%|
| 0.1          | 92.3%        | 78.5%| 82.2%|

### 超参数敏感性分析
- SGD+Momentum对学习率变化较敏感，但在较宽范围内都能正常工作
- Adam对学习率变化最不敏感，表现出强大的自适应能力
- SVRG对学习率高度敏感，需要更精细的调整

## 结论与发现

### 主要发现
1. **最终性能**:
   - SGD+Momentum在所有频率下的最终精度均优于Adam和SVRG
   - 尤其在高频率(3000Hz)数据上，SGD+Momentum的优势最为明显

2. **收敛速度**:
   - Adam在早期收敛速度最快，适合短期训练
   - SGD+Momentum中期后超越Adam，长期训练效果最佳
   - SVRG在所有阶段收敛速度均较慢，但最终可达到较好精度

3. **计算效率**:
   - SGD+Momentum在内存使用和训练时间上最为高效
   - SVRG需要更多的计算资源和训练时间

### 优化器特性总结
- **SGD+Momentum**: 最终性能最好，内存效率高，中后期收敛快
- **Adam**: 早期收敛快，对超参数不敏感，但最终精度略低
- **SVRG**: 理论上有良好的收敛保证，但实际训练效率低，资源消耗大

### 使用建议
1. 对于长期训练和追求最高精度的场景，推荐使用SGD+Momentum
2. 对于快速迭代和原型开发，Adam是更好的选择
3. 当数据集极其嘈杂且梯度方差大时，可考虑SVRG

## 附录：详细实验结果数据

### 500Hz频率完整数据

| 轮数 | SGD+M 训练精度 | SGD+M 验证精度 | Adam 训练精度 | Adam 验证精度 | SVRG 训练精度 | SVRG 验证精度 |
|------|---------------|---------------|--------------|--------------|--------------|--------------|
| 1    | 45.2%         | 44.8%         | 62.1%        | 60.5%        | 38.4%        | 37.9%        |
| 5    | 78.6%         | 77.2%         | 84.3%        | 82.9%        | 69.7%        | 68.5%        |
| 10   | 89.5%         | 87.9%         | 90.2%        | 89.4%        | 82.3%        | 81.2%        |
| 15   | 94.1%         | 92.6%         | 93.6%        | 92.8%        | 89.1%        | 88.3%        |
| 20   | 96.2%         | 94.5%         | 94.8%        | 94.1%        | 92.7%        | 91.9%        |
| 25   | 96.5%         | 94.9%         | 95.1%        | 94.5%        | 93.6%        | 92.8%        |
| 30   | 96.8%         | 95.2%         | 95.3%        | 94.6%        | 94.1%        | 93.5%        |

### 1000Hz频率完整数据

| 轮数 | SGD+M 训练精度 | SGD+M 验证精度 | Adam 训练精度 | Adam 验证精度 | SVRG 训练精度 | SVRG 验证精度 |
|------|---------------|---------------|--------------|--------------|--------------|--------------|
| 1    | 48.6%         | 47.9%         | 64.5%        | 63.2%        | 40.1%        | 39.6%        |
| 5    | 81.2%         | 80.1%         | 86.7%        | 85.5%        | 71.3%        | 70.2%        |
| 10   | 91.4%         | 90.2%         | 92.1%        | 91.4%        | 83.9%        | 82.7%        |
| 15   | 95.3%         | 94.1%         | 94.8%        | 93.9%        | 90.2%        | 89.6%        |
| 20   | 96.7%         | 95.3%         | 95.6%        | 94.7%        | 93.4%        | 92.6%        |
| 25   | 97.1%         | 95.6%         | 95.9%        | 95.0%        | 94.3%        | 93.5%        |
| 30   | 97.3%         | 95.8%         | 96.1%        | 95.2%        | 94.9%        | 94.1%        |

### 3000Hz频率完整数据

| 轮数 | SGD+M 训练精度 | SGD+M 验证精度 | Adam 训练精度 | Adam 验证精度 | SVRG 训练精度 | SVRG 验证精度 |
|------|---------------|---------------|--------------|--------------|--------------|--------------|
| 1    | 52.3%         | 51.6%         | 67.8%        | 66.5%        | 43.2%        | 42.5%        |
| 5    | 84.7%         | 83.3%         | 88.9%        | 87.6%        | 75.1%        | 74.0%        |
| 10   | 93.5%         | 92.1%         | 94.2%        | 93.1%        | 86.8%        | 85.9%        |
| 15   | 96.8%         | 95.4%         | 96.1%        | 94.8%        | 92.4%        | 91.6%        |
| 20   | 97.6%         | 95.9%         | 96.8%        | 95.2%        | 94.6%        | 93.8%        |
| 25   | 97.9%         | 96.1%         | 97.0%        | 95.4%        | 95.3%        | 94.5%        |
| 30   | 98.1%         | 96.3%         | 97.2%        | 95.6%        | 95.7%        | 94.8%        | 