
--- Training Frequency: 1000hz ---
Using random seed: 42
Starting training - Frequency: 1000hz, Material: plastic
Loss type: ghm
GHM Params: bins=20, alpha=0.75, margin=10.0
Using device: mps
Loading Dataset for 1000hz with material plastic
Loading Dataset for 1000hz with material plastic

Class deg000 (label 0):
Found 9 files for class deg000

Class deg036 (label 1):
Found 9 files for class deg036

Class deg072 (label 2):
Found 9 files for class deg072

Class deg108 (label 3):
Found 9 files for class deg108

Class deg144 (label 4):
Found 9 files for class deg144

Class deg180 (label 5):
Found 9 files for class deg180

Spectrograms shape: torch.Size([54, 1, 1025, 1126])
Frequency range: 0.0-24000.0 Hz
Created 1118 ranking pairs
Created 230 ranking pairs
Train ranking pairs: 1118
Validation ranking pairs: 230
Using batch size: 32

===== Epoch 1/30 =====
Batch 10/34 | Main Loss: 0.7357 | Std Loss (log): 9.8987
Batch 20/34 | Main Loss: 1.1963 | Std Loss (log): 9.9073
Batch 30/34 | Main Loss: 1.2770 | Std Loss (log): 9.3050
Epoch 1 Summary
  Training   - Main Loss: 1.2685, Std Loss (log): 9.5483, Accuracy: 56.71%
  Validation - Main Loss: 1.5586, Std Loss (log): 9.3938, Accuracy: 59.38%
  Current learning rate: 0.030000

===== Epoch 2/30 =====
Batch 10/34 | Main Loss: 1.8878 | Std Loss (log): 5.3750
Batch 20/34 | Main Loss: 1.4810 | Std Loss (log): 8.9489
Batch 30/34 | Main Loss: 1.7262 | Std Loss (log): 7.6878
Epoch 2 Summary
  Training   - Main Loss: 1.9058, Std Loss (log): 7.5478, Accuracy: 70.22%
  Validation - Main Loss: 1.6367, Std Loss (log): 9.9662, Accuracy: 47.32%
  Current learning rate: 0.030000

===== Epoch 3/30 =====
Batch 10/34 | Main Loss: 1.4198 | Std Loss (log): 7.2681
Batch 20/34 | Main Loss: 1.7132 | Std Loss (log): 5.6133
Batch 30/34 | Main Loss: 1.3180 | Std Loss (log): 6.0114
Epoch 3 Summary
  Training   - Main Loss: 1.6351, Std Loss (log): 6.6849, Accuracy: 71.14%
  Validation - Main Loss: 8.5899, Std Loss (log): 19.2766, Accuracy: 54.46%
  Current learning rate: 0.030000

===== Epoch 4/30 =====
Batch 10/34 | Main Loss: 1.5374 | Std Loss (log): 5.2756
Batch 20/34 | Main Loss: 1.0607 | Std Loss (log): 4.4891
Batch 30/34 | Main Loss: 1.4417 | Std Loss (log): 7.1697
Epoch 4 Summary
  Training   - Main Loss: 1.6868, Std Loss (log): 6.3788, Accuracy: 73.07%
  Validation - Main Loss: 3.6064, Std Loss (log): 16.7207, Accuracy: 38.84%
  Current learning rate: 0.030000

===== Epoch 5/30 =====
Batch 10/34 | Main Loss: 2.4331 | Std Loss (log): 6.1773
Batch 20/34 | Main Loss: 1.3598 | Std Loss (log): 6.0015
Batch 30/34 | Main Loss: 1.2473 | Std Loss (log): 4.2381
Epoch 5 Summary
  Training   - Main Loss: 1.7233, Std Loss (log): 5.7305, Accuracy: 75.00%
  Validation - Main Loss: 8.5311, Std Loss (log): 14.4954, Accuracy: 56.25%
  Current learning rate: 0.015000
Model checkpoint saved to: /Users/sbplab/Hank/angle_classification_deg6/saved_models/model_checkpoints/plastic_1000hz_ghm_20250414_141127/model_epoch_5.pt

===== Epoch 6/30 =====
Batch 10/34 | Main Loss: 1.9032 | Std Loss (log): 4.4458
Batch 20/34 | Main Loss: 0.8532 | Std Loss (log): 4.7953
Batch 30/34 | Main Loss: 1.8215 | Std Loss (log): 8.1227
Epoch 6 Summary
  Training   - Main Loss: 1.6015, Std Loss (log): 5.0936, Accuracy: 79.04%
  Validation - Main Loss: 2.6280, Std Loss (log): 11.5168, Accuracy: 42.41%
  Current learning rate: 0.015000

===== Epoch 7/30 =====
Batch 10/34 | Main Loss: 1.2579 | Std Loss (log): 3.3900
Batch 20/34 | Main Loss: 0.9665 | Std Loss (log): 3.9331
Batch 30/34 | Main Loss: 1.3324 | Std Loss (log): 5.2095
Epoch 7 Summary
  Training   - Main Loss: 1.3160, Std Loss (log): 4.2633, Accuracy: 81.99%
  Validation - Main Loss: 1.4346, Std Loss (log): 7.3015, Accuracy: 66.96%
  Current learning rate: 0.015000

===== Epoch 8/30 =====
Batch 10/34 | Main Loss: 0.6303 | Std Loss (log): 2.6013
Batch 20/34 | Main Loss: 1.3457 | Std Loss (log): 3.1466
Batch 30/34 | Main Loss: 2.2966 | Std Loss (log): 4.0709
Epoch 8 Summary
  Training   - Main Loss: 1.2689, Std Loss (log): 3.6380, Accuracy: 85.75%
  Validation - Main Loss: 1.3615, Std Loss (log): 7.1861, Accuracy: 65.18%
  Current learning rate: 0.015000

===== Epoch 9/30 =====
Batch 10/34 | Main Loss: 0.5315 | Std Loss (log): 1.5339
Batch 20/34 | Main Loss: 1.2197 | Std Loss (log): 5.0770
Batch 30/34 | Main Loss: 1.0360 | Std Loss (log): 2.4840
Epoch 9 Summary
  Training   - Main Loss: 1.1455, Std Loss (log): 3.4828, Accuracy: 85.48%
  Validation - Main Loss: 2.0742, Std Loss (log): 6.8249, Accuracy: 69.20%
  Current learning rate: 0.015000

===== Epoch 10/30 =====
Batch 10/34 | Main Loss: 1.4599 | Std Loss (log): 2.2319
Batch 20/34 | Main Loss: 0.5293 | Std Loss (log): 1.9589
Batch 30/34 | Main Loss: 2.5438 | Std Loss (log): 4.1748
Epoch 10 Summary
  Training   - Main Loss: 1.0542, Std Loss (log): 2.7533, Accuracy: 90.17%
  Validation - Main Loss: 1.9636, Std Loss (log): 5.9492, Accuracy: 75.45%
  Current learning rate: 0.015000
Model checkpoint saved to: /Users/sbplab/Hank/angle_classification_deg6/saved_models/model_checkpoints/plastic_1000hz_ghm_20250414_141127/model_epoch_10.pt

===== Epoch 11/30 =====
Batch 10/34 | Main Loss: 0.5689 | Std Loss (log): 0.8245
Batch 20/34 | Main Loss: 0.5797 | Std Loss (log): 1.5554
Batch 30/34 | Main Loss: 1.0361 | Std Loss (log): 2.6354
Epoch 11 Summary
  Training   - Main Loss: 1.0981, Std Loss (log): 2.7147, Accuracy: 89.98%
  Validation - Main Loss: 1.7670, Std Loss (log): 6.4286, Accuracy: 75.00%
  Current learning rate: 0.015000

===== Epoch 12/30 =====
Batch 10/34 | Main Loss: 1.1445 | Std Loss (log): 1.8510
Batch 20/34 | Main Loss: 0.5622 | Std Loss (log): 1.1544
Batch 30/34 | Main Loss: 0.4586 | Std Loss (log): 1.5703
Epoch 12 Summary
  Training   - Main Loss: 0.7898, Std Loss (log): 1.9265, Accuracy: 92.65%
  Validation - Main Loss: 13.3859, Std Loss (log): 19.8414, Accuracy: 49.11%
  Current learning rate: 0.007500

===== Epoch 13/30 =====
Batch 10/34 | Main Loss: 0.8009 | Std Loss (log): 0.9221
Batch 20/34 | Main Loss: 0.8612 | Std Loss (log): 1.5862
Batch 30/34 | Main Loss: 0.4483 | Std Loss (log): 0.7876
Epoch 13 Summary
  Training   - Main Loss: 0.8209, Std Loss (log): 1.6748, Accuracy: 94.03%
  Validation - Main Loss: 2.0775, Std Loss (log): 7.4663, Accuracy: 72.77%
  Current learning rate: 0.007500

===== Epoch 14/30 =====
Batch 10/34 | Main Loss: 0.6778 | Std Loss (log): 2.3079
Batch 20/34 | Main Loss: 0.9472 | Std Loss (log): 3.1356
Batch 30/34 | Main Loss: 0.4423 | Std Loss (log): 1.4788
Epoch 14 Summary
  Training   - Main Loss: 0.8313, Std Loss (log): 1.7428, Accuracy: 92.83%
  Validation - Main Loss: 1.6312, Std Loss (log): 5.6454, Accuracy: 77.68%
  Current learning rate: 0.007500

===== Epoch 15/30 =====
Batch 10/34 | Main Loss: 0.5028 | Std Loss (log): 1.1630
Batch 20/34 | Main Loss: 0.9676 | Std Loss (log): 2.2511
Batch 30/34 | Main Loss: 0.7075 | Std Loss (log): 1.5937
Epoch 15 Summary
  Training   - Main Loss: 0.7971, Std Loss (log): 1.5663, Accuracy: 93.38%
  Validation - Main Loss: 4.0998, Std Loss (log): 11.5067, Accuracy: 58.93%
  Current learning rate: 0.007500
Model checkpoint saved to: /Users/sbplab/Hank/angle_classification_deg6/saved_models/model_checkpoints/plastic_1000hz_ghm_20250414_141127/model_epoch_15.pt

===== Epoch 16/30 =====
Batch 10/34 | Main Loss: 0.1828 | Std Loss (log): 0.3424
Batch 20/34 | Main Loss: 0.4839 | Std Loss (log): 1.9739
Batch 30/34 | Main Loss: 0.3728 | Std Loss (log): 0.6317
Epoch 16 Summary
  Training   - Main Loss: 0.5809, Std Loss (log): 1.0902, Accuracy: 95.96%
  Validation - Main Loss: 2.3819, Std Loss (log): 6.9623, Accuracy: 73.21%
  Current learning rate: 0.003750

===== Epoch 17/30 =====
Batch 10/34 | Main Loss: 0.3300 | Std Loss (log): 0.7819
Batch 20/34 | Main Loss: 0.3746 | Std Loss (log): 0.3746
Batch 30/34 | Main Loss: 0.4394 | Std Loss (log): 0.8282
Epoch 17 Summary
  Training   - Main Loss: 0.5818, Std Loss (log): 1.0893, Accuracy: 96.42%
  Validation - Main Loss: 3.8435, Std Loss (log): 8.0690, Accuracy: 74.11%
  Current learning rate: 0.003750

===== Epoch 18/30 =====
Batch 10/34 | Main Loss: 0.2373 | Std Loss (log): 0.5113
Batch 20/34 | Main Loss: 0.3650 | Std Loss (log): 1.1115
Batch 30/34 | Main Loss: 0.3158 | Std Loss (log): 0.9602
Epoch 18 Summary
  Training   - Main Loss: 0.4007, Std Loss (log): 0.8003, Accuracy: 97.70%
  Validation - Main Loss: 2.4895, Std Loss (log): 6.6637, Accuracy: 75.45%
  Current learning rate: 0.003750

===== Epoch 19/30 =====
Batch 10/34 | Main Loss: 0.6028 | Std Loss (log): 1.1955
Batch 20/34 | Main Loss: 0.0944 | Std Loss (log): 0.1746
Batch 30/34 | Main Loss: 0.2832 | Std Loss (log): 0.5554
Epoch 19 Summary
  Training   - Main Loss: 0.3872, Std Loss (log): 0.7314, Accuracy: 98.35%
  Validation - Main Loss: 3.9963, Std Loss (log): 8.3497, Accuracy: 73.66%
  Current learning rate: 0.003750

===== Epoch 20/30 =====
Batch 10/34 | Main Loss: 0.2211 | Std Loss (log): 0.2975
Batch 20/34 | Main Loss: 0.0228 | Std Loss (log): 0.3061
Batch 30/34 | Main Loss: 0.1316 | Std Loss (log): 0.3369
Epoch 20 Summary
  Training   - Main Loss: 0.5014, Std Loss (log): 0.9557, Accuracy: 96.78%
  Validation - Main Loss: 3.4088, Std Loss (log): 7.7434, Accuracy: 72.32%
  Current learning rate: 0.001875
Model checkpoint saved to: /Users/sbplab/Hank/angle_classification_deg6/saved_models/model_checkpoints/plastic_1000hz_ghm_20250414_141127/model_epoch_20.pt

===== Epoch 21/30 =====
Batch 10/34 | Main Loss: 0.3872 | Std Loss (log): 0.3872
Batch 20/34 | Main Loss: 0.0267 | Std Loss (log): 0.3502
Batch 30/34 | Main Loss: 0.5238 | Std Loss (log): 0.6957
Epoch 21 Summary
  Training   - Main Loss: 0.3780, Std Loss (log): 0.7736, Accuracy: 98.16%
  Validation - Main Loss: 3.2111, Std Loss (log): 8.0411, Accuracy: 73.66%
  Current learning rate: 0.001875

===== Epoch 22/30 =====
Batch 10/34 | Main Loss: 0.0000 | Std Loss (log): 0.0000
Batch 20/34 | Main Loss: 0.2735 | Std Loss (log): 1.0155
Batch 30/34 | Main Loss: 0.0135 | Std Loss (log): 0.1816
Epoch 22 Summary
  Training   - Main Loss: 0.3032, Std Loss (log): 0.6341, Accuracy: 98.44%
  Validation - Main Loss: 2.7385, Std Loss (log): 7.0698, Accuracy: 77.68%
  Current learning rate: 0.001875

===== Epoch 23/30 =====
Batch 10/34 | Main Loss: 0.3651 | Std Loss (log): 0.5901
Batch 20/34 | Main Loss: 0.3050 | Std Loss (log): 0.3696
Batch 30/34 | Main Loss: 0.9858 | Std Loss (log): 1.1334
Epoch 23 Summary
  Training   - Main Loss: 0.3530, Std Loss (log): 0.6299, Accuracy: 98.71%
  Validation - Main Loss: 4.1127, Std Loss (log): 9.5251, Accuracy: 70.09%
  Current learning rate: 0.001875

===== Epoch 24/30 =====
Batch 10/34 | Main Loss: 0.2888 | Std Loss (log): 0.6583
Batch 20/34 | Main Loss: 0.3310 | Std Loss (log): 0.5353
Batch 30/34 | Main Loss: 0.1033 | Std Loss (log): 0.1245
Epoch 24 Summary
  Training   - Main Loss: 0.3045, Std Loss (log): 0.5981, Accuracy: 98.53%
  Validation - Main Loss: 3.2927, Std Loss (log): 7.6967, Accuracy: 75.45%
  Current learning rate: 0.000937

===== Epoch 25/30 =====
Batch 10/34 | Main Loss: 0.0000 | Std Loss (log): 0.0000
Batch 20/34 | Main Loss: 0.1818 | Std Loss (log): 0.2038
Batch 30/34 | Main Loss: 0.3300 | Std Loss (log): 0.5689
Epoch 25 Summary
  Training   - Main Loss: 0.2759, Std Loss (log): 0.4091, Accuracy: 99.17%
  Validation - Main Loss: 3.5993, Std Loss (log): 8.0003, Accuracy: 75.45%
  Current learning rate: 0.000937
Model checkpoint saved to: /Users/sbplab/Hank/angle_classification_deg6/saved_models/model_checkpoints/plastic_1000hz_ghm_20250414_141127/model_epoch_25.pt

===== Epoch 26/30 =====
Batch 10/34 | Main Loss: 0.8896 | Std Loss (log): 1.5557
Batch 20/34 | Main Loss: 0.2874 | Std Loss (log): 0.3804
Batch 30/34 | Main Loss: 0.1820 | Std Loss (log): 0.3409
Epoch 26 Summary
  Training   - Main Loss: 0.3217, Std Loss (log): 0.6977, Accuracy: 97.98%
  Validation - Main Loss: 3.1146, Std Loss (log): 7.5407, Accuracy: 77.68%
  Current learning rate: 0.000937

===== Epoch 27/30 =====
Batch 10/34 | Main Loss: 0.2111 | Std Loss (log): 0.3001
Batch 20/34 | Main Loss: 0.0188 | Std Loss (log): 0.1022
Batch 30/34 | Main Loss: 0.2214 | Std Loss (log): 0.2214
Epoch 27 Summary
  Training   - Main Loss: 0.3042, Std Loss (log): 0.4962, Accuracy: 98.71%
  Validation - Main Loss: 3.1809, Std Loss (log): 7.6054, Accuracy: 76.79%
  Current learning rate: 0.000937

===== Epoch 28/30 =====
Batch 10/34 | Main Loss: 0.3115 | Std Loss (log): 0.7102
Batch 20/34 | Main Loss: 0.3756 | Std Loss (log): 0.7560
Batch 30/34 | Main Loss: 0.2861 | Std Loss (log): 0.4396
Epoch 28 Summary
  Training   - Main Loss: 0.2361, Std Loss (log): 0.4761, Accuracy: 98.99%
  Validation - Main Loss: 3.0097, Std Loss (log): 7.4282, Accuracy: 76.34%
  Current learning rate: 0.000469

===== Epoch 29/30 =====
Batch 10/34 | Main Loss: 0.0629 | Std Loss (log): 0.0629
Batch 20/34 | Main Loss: 0.1265 | Std Loss (log): 0.1265
Batch 30/34 | Main Loss: 0.2562 | Std Loss (log): 0.5215
Epoch 29 Summary
  Training   - Main Loss: 0.2596, Std Loss (log): 0.4409, Accuracy: 99.08%
  Validation - Main Loss: 3.1042, Std Loss (log): 7.7766, Accuracy: 75.89%
  Current learning rate: 0.000469

===== Epoch 30/30 =====
Batch 10/34 | Main Loss: 0.0009 | Std Loss (log): 0.0113
Batch 20/34 | Main Loss: 0.4343 | Std Loss (log): 0.7303
Batch 30/34 | Main Loss: 0.3577 | Std Loss (log): 0.7289
Epoch 30 Summary
  Training   - Main Loss: 0.1776, Std Loss (log): 0.3367, Accuracy: 99.36%
  Validation - Main Loss: 2.6806, Std Loss (log): 7.6769, Accuracy: 74.55%
  Current learning rate: 0.000469
Model checkpoint saved to: /Users/sbplab/Hank/angle_classification_deg6/saved_models/model_checkpoints/plastic_1000hz_ghm_20250414_141127/model_epoch_30.pt
Training history plot saved to: /Users/sbplab/Hank/angle_classification_deg6/saved_models/plots/plastic_1000hz_ghm_20250414_141127/training_history_20250414_141127.png
Training history saved to: /Users/sbplab/Hank/angle_classification_deg6/saved_models/model_checkpoints/plastic_1000hz_ghm_20250414_141127/training_history_20250414_141127.pkl

--- Finished training 1000hz ---
