# 困難樣本分析報告

## 執行結果摘要

在執行修正後的 `find_difficult_samples.py` 程式後，我們發現：

1. 總共分析了54個樣本，涵蓋了30個訓練epoch
2. 識別出2個持續困難的樣本（在bin 9出現至少6次）：
   - plastic_deg000_1000hz_00（角度0°，材料：plastic）
   - plastic_deg180_1000hz_05（角度180°，材料：plastic）
3. 沒有高度困難的樣本（在bin 9出現至少12次）
4. 困難樣本的角度分布：0° 和 180° 各佔50%

## 困難樣本的bin歷史分析

### plastic_deg000_1000hz_00

```
[9, 9, 8, 9, 8, 9, 9, 9, 9, 0, 6, 8, 2, 6, 6, 5, 5, -, 8, 4, 0, 3, -, 5, 0, 8, 1, 2, -, 3]
```

觀察到的模式：
- 初期階段（前9個epoch）：幾乎全部在高bin值區域（bin 8-9），表示非常困難
- 中間階段：困難程度明顯下降，在bin 0-6之間波動
- 後期階段：困難程度繼續波動，但整體保持在中低水平（bin 0-8）
- 樣本在7個epoch中被歸類為bin 9，佔總訓練的23.3%

### plastic_deg180_1000hz_05

```
[5, 0, 6, 5, 6, 5, 9, 0, 6, 9, 2, -, 9, 9, 4, 6, 9, 9, 4, 8, 0, 0, 4, 5, -, 0, 4, 0, 5, 6]
```

觀察到的模式：
- 初期階段：困難程度變化大，在bin 0-9之間波動
- 中期階段（12-19 epoch）：出現多次高困難度記錄（bin 9）
- 後期階段：困難程度總體降低，主要在低到中等範圍（bin 0-6）
- 樣本在6個epoch中被歸類為bin 9，佔總訓練的20.0%

## 困難因素分析

根據GHM機制和樣本特徵，以下因素可能導致這些樣本持續困難：

### 1. 極端角度因素

兩個困難樣本分別位於0°和180°，這是角度的極值。這種情況可能導致:
- **梯度不穩定**：在極值處，模型可能難以學習角度變化的連續性
- **邊界效應**：0°和180°在角度空間中分別位於反方向，但在物理上可能表現相似
- **週期性問題**：角度的週期性（如0°和360°等效）可能使模型難以處理這些邊界情況

### 2. 材料特性因素

兩個困難樣本都使用plastic材料，這可能表明：
- **聲學特性**：plastic材料的聲波反射和吸收特性可能造成特殊的聲學模式
- **頻譜特性**：1000Hz頻率在plastic材料上可能產生特殊的頻譜特徵
- **信噪比**：plastic材料可能導致特定頻率的信號強度較弱或噪聲較多

### 3. 學習動態分析

樣本的bin歷史顯示出有趣的學習動態：
- **逐漸適應**：多數困難樣本在訓練後期變得較容易，表明模型逐漸適應了這些樣本
- **不穩定性**：bin值的大幅波動表明模型對這些樣本的預測不穩定
- **過擬合風險**：某些epoch中困難程度突然增加，可能表明模型在這些樣本上出現過擬合

## 建議的解決方案

針對分析結果，我建議以下策略來改進模型對這些困難樣本的處理：

1. **數據增強策略**：
   - 對極端角度（0°和180°）附近進行更密集的採樣
   - 對plastic材料的樣本進行額外的數據增強
   - 在1000Hz頻率附近添加微小擾動生成更多樣本

2. **模型優化**：
   - 考慮在損失函數中添加特定於角度極值處理的正則化項
   - 嘗試使用循環結構或周期嵌入來更好處理角度的周期性
   - 增加模型對plastic材料在1000Hz頻率特徵的敏感度

3. **評估改進**：
   - 對0°和180°角度樣本進行特別的評估
   - 分析plastic材料在不同頻率下的表現模式
   - 監控困難樣本在不同訓練階段的預測誤差

## 結論

通過分析GHM bin分配歷史，我們識別出兩個持續困難的樣本，它們都分別位於角度的極值（0°和180°）並使用相同的材料（plastic）。這些樣本在訓練過程中表現出了不同的困難模式，但整體上顯示了模型在學習極端角度時的挑戰。針對性的數據增強和模型改進可能有助於解決這些難點，提高模型在整個角度範圍內的泛化能力。 